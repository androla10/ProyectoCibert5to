package com.cibertec.interceptor;

import java.util.Map;

import com.opensymphony.xwork2.ActionInvocation;
import com.opensymphony.xwork2.interceptor.Interceptor;

public class Autenticacion implements Interceptor {

	@Override
	public void destroy() {
		// TODO Auto-generated method stub
		
	}

	@Override
	public void init() {
		// TODO Auto-generated method stub
		
	}

	@Override
	public String intercept(ActionInvocation arg0) throws Exception {
		Map session = actionInvocation.getInvocationContext().getSession();
	      Usuario usuario = (Usuario) session.get("usuario");
	      if (usuario == null) {
	          return Action.LOGIN;
	      } else {
	          Action action = (Action) actionInvocation.getAction();
	          if (action instanceof UsuarioHabilitado) {
	              ((UsuarioHabilitado) action).setUsuario(usuario);
	          }
	          return actionInvocation.invoke();
	      }
	}

}
